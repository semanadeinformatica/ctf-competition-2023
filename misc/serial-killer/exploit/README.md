# Serial Killer

In this challenge, we gain access to a remote shell.

If we run `ps aux`, we see a few processes running. One of them is a Java program called `app`, located inside the `serial-killer` folder.

To see the source of the program, we need to download the binary, but how do we do it?
One way is to run `cat <file> | base64 -`. This will give us a base64 string representing the Java file.

```
> cat serial-killer/lib/app.jar | base64

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
AAAZAAAAAAAAAAAAEADtQe0AAABwdC9zaW5mL2N0Zi9zZXJpYWxraWxsZXIvUEsBAhQDFAAACAgA
MpVfV4a9CNwABgAAJA0AACQAAAAAAAAAAAAAAKSBJgEAAHB0L3NpbmYvY3RmL3NlcmlhbGtpbGxl
ci9BcHBLdC5jbGFzc1BLAQIUAxQAAAgIADKVX1dlF4PexgIAACwFAAA9AAAAAAAAAAAAAACkgWgH
AABwdC9zaW5mL2N0Zi9zZXJpYWxraWxsZXIvQXBwS3QkbWFpbiRlbmNyeXB0aW9uU2VydmljZSQx
LmNsYXNzUEsBAhQDFAAACAgAMpVfV0Kxs8XfAgAAfAUAADAAAAAAAAAAAAAAAKSBiQoAAHB0L3Np
bmYvY3RmL3NlcmlhbGtpbGxlci9BcHBLdCRtYWluJGZsYWckMS5jbGFzc1BLAQIUAxQAAAgIADKV
X1c+VXbdjwcAAKQOAAAwAAAAAAAAAAAAAACkgbYNAABwdC9zaW5mL2N0Zi9zZXJpYWxraWxsZXIv
RW5jcnlwdGlvblNlcnZpY2UuY2xhc3NQSwECFAMUAAAICAAylV9Xs1nycl8CAAD+AwAAOgAAAAAA
AAAAAAAApIGTFQAAcHQvc2luZi9jdGYvc2VyaWFsa2lsbGVyL0VuY3J5cHRpb25TZXJ2aWNlJENv
bXBhbmlvbi5jbGFzc1BLAQIUAxQAAAgIADKVX1fYAUWM5AEAAMwCAAAyAAAAAAAAAAAAAACkgUoY
AABwdC9zaW5mL2N0Zi9zZXJpYWxraWxsZXIvRW5jcnlwdGlvblNlcnZpY2VLdC5jbGFzc1BLAQIU
AxQAAAgIADKVX1cTpphZGgcAAOcOAAAzAAAAAAAAAAAAAACkgX4aAABwdC9zaW5mL2N0Zi9zZXJp
YWxraWxsZXIvU2VyaWFsaXphdGlvblNlcnZpY2UuY2xhc3NQSwECFAMUAAAICAAylV9Xa/VCL0sA
AABQAAAAGgAAAAAAAAAAAAAApIHpIQAATUVUQS1JTkYvYXBwLmtvdGxpbl9tb2R1bGVQSwUGAAAA
AA4ADgBLBAAAbCIAAAAA
```

Now, we can take this and write the JAR file to our computer.

```
> echo '<base64 string>' | base64 -d > app.jar
```

Now, we can use a JAR decompiler, such as `jd-gui`, to decompile the Java program.

Unfortunately, this program is written in Kotlin and the decompilation isn't very good.
We could try using a decompiler specific for Kotlin, but we can still work some things out.

```java
public static final void main(@NotNull String[] args) {
  // Byte code:
  /* ... */
  //   109: <illegal opcode> run : (Lpt/sinf/ctf/serialkiller/SerializationService;Ljava/nio/file/Path;Lpt/sinf/ctf/serialkiller/EncryptionService;Ljava/nio/file/Path;Ljava/lang/String;)Ljava/lang/Runnable;
  /* ... */
  //   114: invokespecial <init> : (Ljava/lang/Runnable;)V
  /* ... */
  //   117: invokevirtual addShutdownHook : (Ljava/lang/Thread;)V
}

private static final void main$lambda$0(SerializationService $serializationService, Path $encryptionServicePath, EncryptionService $encryptionService, Path $flagPath, String $flag) {
  Intrinsics.checkNotNullParameter($serializationService, "$serializationService");
  Intrinsics.checkNotNullParameter($encryptionService, "$encryptionService");
  Intrinsics.checkNotNullParameter($flag, "$flag");
  Intrinsics.checkNotNullExpressionValue($encryptionServicePath, "encryptionServicePath");
  $serializationService.save($encryptionServicePath, $encryptionService);
  Intrinsics.checkNotNullExpressionValue($flagPath, "flagPath");
  $serializationService.save($flagPath, $flag);
}
```

In the main function, we can see that a shutdown hook is executed and it has something to do with a function that takes a `SerializationService`, a `Path`, an `EncryptionService`, another `Path` and a `String`, in this order.
In the decompilation, we can see that there is a function called `main$lambda$0` that takes those parameters in that order, therefore, it should be safe to assume that the lambda function is run when the program is killed.

If we used a website like [http://www.javadecompilers.com/](http://www.javadecompilers.com/), we could see even more of the source code. We would see something like the following:

```java
// 
// Decompiled by Procyon v0.5.36
// 

package pt.sinf.ctf.serialkiller;

import kotlin.reflect.KClass;
import kotlin.jvm.functions.Function0;
import kotlin.jvm.internal.Reflection;
import java.nio.file.Path;
import kotlin.jvm.internal.Intrinsics;
import org.jetbrains.annotations.NotNull;
import kotlin.Metadata;

@Metadata(mv = { 1, 8, 0 }, k = 2, xi = 48, d1 = { "\u0000\u0014\n\u0000\n\u0002\u0010\u0002\n\u0000\n\u0002\u0010\u0011\n\u0002\u0010\u000e\n\u0002\b\u0002\u001a\u0019\u0010\u0000\u001a\u00020\u00012\f\u0010\u0002\u001a\b\u0012\u0004\u0012\u00020\u00040\u0003¢\u0006\u0002\u0010\u0005¨\u0006\u0006" }, d2 = { "main", "", "args", "", "", "([Ljava/lang/String;)V", "app" })
public final class AppKt
{
    public static final void main(@NotNull final String[] args) {
        Intrinsics.checkNotNullParameter((Object)args, "args");
        final SerializationService serializationService = new SerializationService();
        final Path encryptionServicePath = Path.of("encryption_service.dat", new String[0]);
        final Path flagPath = Path.of("flag.dat", new String[0]);
        final SerializationService serializationService2 = serializationService;
        Intrinsics.checkNotNullExpressionValue((Object)encryptionServicePath, "encryptionServicePath");
        final EncryptionService encryptionService = serializationService2.restore(encryptionServicePath, (kotlin.reflect.KClass<EncryptionService>)Reflection.getOrCreateKotlinClass((Class)EncryptionService.class), (kotlin.jvm.functions.Function0<? extends EncryptionService>)AppKt$main$encryptionService.AppKt$main$encryptionService$1.INSTANCE);
        final SerializationService serializationService3 = serializationService;
        Intrinsics.checkNotNullExpressionValue((Object)flagPath, "flagPath");
        final String flag = serializationService3.restore(flagPath, (kotlin.reflect.KClass<String>)Reflection.getOrCreateKotlinClass((Class)String.class), (kotlin.jvm.functions.Function0<? extends String>)new AppKt$main$flag.AppKt$main$flag$1(encryptionService, args));
        Runtime.getRuntime().addShutdownHook(new Thread(AppKt::main$lambda$0));
        if (args.length != 0) {
            return;
        }
        while (true) {
            Thread.sleep(10000L);
        }
    }
    
    private static final void main$lambda$0(final SerializationService $serializationService, final Path $encryptionServicePath, final EncryptionService $encryptionService, final Path $flagPath, final String $flag) {
        Intrinsics.checkNotNullParameter((Object)$serializationService, "$serializationService");
        Intrinsics.checkNotNullParameter((Object)$encryptionService, "$encryptionService");
        Intrinsics.checkNotNullParameter((Object)$flag, "$flag");
        Intrinsics.checkNotNullExpressionValue((Object)$encryptionServicePath, "encryptionServicePath");
        $serializationService.save($encryptionServicePath, $encryptionService);
        Intrinsics.checkNotNullExpressionValue((Object)$flagPath, "flagPath");
        $serializationService.save($flagPath, $flag);
    }
}
```

Very interesting... A shutdown hook is indeed added to the program, that serializes the flag and the `EncryptionService` to the `flag.dat` and `encryption_service.dat` files, respectively.

Therefore, by running `ps aux` and then killing the Java process, we can copy the serialized data to our computers, using the base64 method.

Now that we have the serialized data, we can analyze it and extract the flag from it.
Using [SerializationDumper](https://github.com/NickstaDB/SerializationDumper), we can analyze the `.dat` files.

```
> java -jar SerializationDumper-v1.13.jar $(cat encryption_service.dat | hex)

...
Contents
  TC_OBJECT - 0x73
    ...      
    classdata
      pt.sinf.ctf.serialkiller.EncryptionService
        values
          keySize
            (int)128 - 0x00 00 00 80
          algorithm
            (object)
              TC_STRING - 0x74
                ...
                Value - AES_128/OFB/NoPadding - 0x4145535f3132382f4f46422f4e6f50616464696e67
          iv
            (array)
              TC_ARRAY - 0x75
                ...
                Values
                  Index 0:
                    (byte)0 - 0x00
                  Index 1:
                    (byte)0 - 0x00
                  Index 2:
                    (byte)0 - 0x00
                  Index 3:
                    (byte)0 - 0x00
                  Index 4:
                    (byte)0 - 0x00
                  Index 5:
                    (byte)0 - 0x00
                  Index 6:
                    (byte)0 - 0x00
                  Index 7:
                    (byte)0 - 0x00
                  Index 8:
                    (byte)0 - 0x00
                  Index 9:
                    (byte)0 - 0x00
                  Index 10:
                    (byte)0 - 0x00
                  Index 11:
                    (byte)0 - 0x00
                  Index 12:
                    (byte)0 - 0x00
                  Index 13:
                    (byte)0 - 0x00
                  Index 14:
                    (byte)0 - 0x00
                  Index 15:
                    (byte)0 - 0x00
          key
            (object)
              TC_OBJECT - 0x73
                ...
                classdata
                  javax.crypto.spec.SecretKeySpec
                    values
                      algorithm
                        (object)
                          TC_STRING - 0x74
                            newHandle 0x00 7e 00 0a
                            Length - 3 - 0x00 03
                            Value - AES - 0x414553
                      key
                        (array)
                          TC_ARRAY - 0x75
                            TC_REFERENCE - 0x71
                              Handle - 8257542 - 0x00 7e 00 06
                            newHandle 0x00 7e 00 0b
                            Array size - 16 - 0x00 00 00 10
                            Values
                              Index 0:
                                (byte)27 - 0x1b
                              Index 1:
                                (byte)-120 - 0x88
                              Index 2:
                                (byte)-74 - 0xb6
                              Index 3:
                                (byte)-58 - 0xc6
                              Index 4:
                                (byte)-67 - 0xbd
                              Index 5:
                                (byte)28 - 0x1c
                              Index 6:
                                (byte)1 - 0x01
                              Index 7:
                                (byte)-68 - 0xbc
                              Index 8:
                                (byte)-32 - 0xe0
                              Index 9:
                                (byte)15 - 0x0f
                              Index 10:
                                (byte)125 (ASCII: }) - 0x7d
                              Index 11:
                                (byte)-109 - 0x93
                              Index 12:
                                (byte)-16 - 0xf0
                              Index 13:
                                (byte)-88 - 0xa8
                              Index 14:
                                (byte)-17 - 0xef
                              Index 15:
                                (byte)-1 - 0xff
```

```
> java -jar SerializationDumper-v1.13.jar $(cat flag.dat | hex)

...
Contents
  TC_STRING - 0x74
    newHandle 0x00 7e 00 00
    Length - 60 - 0x00 3c
    Value - t39plCkElT4Xd4RFxaSFlZdEF5NHUwLtDrZQsS8jDa2XTYJT5h3aFGdlBBQ= - 0x743339706c436b456c54345864345246786153466c5a644546354e4855774c7444725a517353386a4461325854594a54356833614647646c4242513d
```

From these files, we can get the algorithm used for encryption, the key size, the IV, the encryption key and the encrypted flag in base64. Since symmetric encryption is used (AES), we can decrypt the flag.

A full exploit is available in the `exploit.py` file.
