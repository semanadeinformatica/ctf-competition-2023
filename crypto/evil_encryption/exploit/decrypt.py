OUTPUT_FILEPATH = 'flag'

def debinarize(enc: bytes):
    text = ""
    shifts = [64, 4, 2, 16, 1, 8, 32][::-1]
    for c in enc:
        byte = 0
        for shift in shifts:
            byte += c % 2 * shift
            c //= 2
        text += chr(byte)
    return text

def decombine_key(enc, key):
    text = ''
    for i, c in enumerate(enc):
        text += chr((ord(c) - ord(key[i % len(key)])) % 127)
    return text

with open(OUTPUT_FILEPATH, 'rb') as file:
    flag = file.read()
    debin = debinarize(flag)
    key = decombine_key(debin[:11], "SINFCTF2023")
    print(decombine_key(debin, key))